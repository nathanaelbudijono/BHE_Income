@using System.Globalization
<style>
    .dx-texteditor.dx-editor-outlined {
        padding: 2px 5px !important;
    }
</style>
<main class="px-6 py-4 min-h-screen space-y-10">
    <section>
        <Typography variant="h4" font="bold" color="dark">Virtual Account</Typography>
        <Typography>
            This section provides access to Virtual Account (VA) mutation data. You can view detailed records of incoming transactions, and export the data to Excel for further analysis.
        </Typography>
    </section>
    <section>
        <Typography variant="h6" font="semibold" color="dark">This Month Insights</Typography>
        <Typography variant="sm">
            Key highlights of virtual account bank mutations, transactions, and amounts processed this month.
        </Typography>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-5">
            <div class="bg-white rounded-lg border border-gray-200 shadow-sm p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <Typography variant="p" font="semibold" color="dark">Total Integrations</Typography>
                        <p class="text-2xl max-lg:text-xl poppins-bold text-slate-800 mt-1" id="integration-data"></p>
                    </div>
                    <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                        <i class="ri-bar-chart-fill text-lg text-primary-100"></i>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg border border-gray-200 shadow-sm p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <Typography variant="p" font="semibold" color="dark">Total Amount</Typography>
                        <p class="text-2xl max-lg:text-xl poppins-bold text-slate-800 mt-1" id="amount-data"></p>
                    </div>
                    <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                        <i class="ri-pulse-fill text-lg text-success-100"></i>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg border border-gray-200 shadow-sm p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <Typography variant="p" font="semibold" color="dark">Total Transaction</Typography>
                        <p class="text-2xl max-lg:text-xl poppins-bold text-slate-800 mt-1" id="transaction-data"></p>
                    </div>
                    <div class="w-12 h-12 bg-purple-200 rounded-lg flex items-center justify-center">
                        <i class="ri-funds-line text-lg text-purple-600"></i></i>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg border border-gray-200 shadow-sm p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <Typography variant="p" font="semibold" color="dark">Last Uploaded</Typography>
                        <p class="text-2xl max-lg:text-xl poppins-bold text-slate-800 mt-1" id="upload-data"></p>
                    </div>
                    <div class="w-12 h-12 bg-secondary-accent-200 rounded-lg flex items-center justify-center">
                        <i class="ri-time-line text-lg text-secondary-100"></i>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section>
        <Typography variant="h6" font="semibold" color="dark">Uploaded Mutations</Typography>
        <div class="flex justify-between items-center gap-5 mt-5">
            <button class="primary-btn h-fit">Upload</button>
            @(Html.DevExtreme().DateRangeBox()
                        .Width(300)
                        .OnValueChanged("onVaDateRangeChanged")
                        .ID("vaDateRange")
                        .Value(new[] {
                        DateTime.Now.AddDays(-14).ToString("yyyy-MM-dd", CultureInfo.InvariantCulture),
                        DateTime.Now.ToString("yyyy-MM-dd", CultureInfo.InvariantCulture)
                        })
                        )
        </div>
        <div x-data="{
        tabSelected: 1,
        tabId: $id('tabs'),
        tabButtonClicked(tabButton){
            this.tabSelected = tabButton.id.replace(this.tabId + '-', '');
            this.tabRepositionMarker(tabButton);
        },
        tabRepositionMarker(tabButton){
            this.$refs.tabMarker.style.width=tabButton.offsetWidth + 'px';
            this.$refs.tabMarker.style.height=tabButton.offsetHeight + 'px';
            this.$refs.tabMarker.style.left=tabButton.offsetLeft + 'px';
        },
        tabContentActive(tabContent){
            return this.tabSelected == tabContent.id.replace(this.tabId + '-content-', '');
        }
    }"
             x-init="tabRepositionMarker($refs.tabButtons.firstElementChild);" class="relative w-full">

            <div x-ref="tabButtons" class="mt-5 relative inline-grid items-center justify-center w-full h-10 grid-cols-2 p-1 text-gray-500 bg-neutral-accent-200 rounded-lg select-none max-w-sm">
                <button :id="$id(tabId)" @@click="tabButtonClicked($el);" type="button" class="relative z-20 inline-flex items-center justify-center w-full h-8 px-3 transition-all rounded-md cursor-pointer whitespace-nowrap">
                    <Typography>Files</Typography>
                </button>
                <button :id="$id(tabId)" @@click="tabButtonClicked($el);" type="button" class="relative z-20 inline-flex items-center justify-center w-full h-8 px-3 transition-all rounded-md cursor-pointer whitespace-nowrap">
                    <Typography>Mutation</Typography>
                </button>
                <div x-ref="tabMarker" class="absolute left-0 z-10 w-1/2 h-full duration-300 ease-out" x-cloak><div class="w-full h-full bg-white rounded-md shadow-sm"></div></div>
            </div>
            <div class="relative w-full mt-2 content">
                <div :id="$id(tabId + '-content')" x-show="tabContentActive($el)" class="relative w-full">
                    <div id="va-mutation-grid" class="h-full" style="max-height:500px;"></div>
                </div>

                <div :id="$id(tabId + '-content')" x-show="tabContentActive($el)" class="relative" x-cloak>
                </div>

            </div>
        </div>
    </section>
</main>

@section scripts {
    <script src="~/js/Views/BankMutation/virtualAccount.js"></script>
    <script>
          document.addEventListener('DOMContentLoaded', async () => {
              try{
                  showLoader();
                   generateBreadcrumbs(BANK_MUTATION_VA_BREADCRUMBS);
          await BcaVirtualAccountManager.init();
          initBcaVirtualAccountGrid();
              }catch(err){
                  hideLoader();
              }
         
          });
    </script>
}